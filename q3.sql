SELECT 
    SUBSTR(TRANDATE, 1, 6) AS TRANDATE_MONTH,
    TERMINALNO,
    COUNT(CASE WHEN AMOUNT < 50000 AND TRANTYPE = 00 THEN 1 END) * 2300 
    AS FEE_UNDER_50000,
    COUNT(CASE WHEN AMOUNT BETWEEN 50000 AND 250000 AND TRANTYPE = 00 THEN 1 END) * (2500 - (2500 * 0.0001))
    AS FEE_BETWEEN_50000_250000,
    COUNT(CASE WHEN AMOUNT > 250000 AND TRANTYPE = 00 THEN 1 END) * 20600
    AS FEE_ABOVE_250000,
    COUNT(CASE WHEN TRANTYPE = 31 THEN 1 END) * 7500
    AS FEE_BALANCE_TRAN,
    COUNT(CASE WHEN TRANTYPE = 50 THEN 1 END) * 7500
    AS FEE_CHARGE_TRAN

FROM 
    TB_TRANSACTIONS
GROUP BY 
    SUBSTR(TRANDATE, 1, 6),
    TERMINALNO
ORDER BY
    SUBSTR(TRANDATE, 1, 6),
    TERMINALNO